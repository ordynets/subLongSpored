theme(plot.margin = unit(c(0.6,0.6,0.6,0.6), "cm"))
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=17, face="bold", vjust=3.5),
axis.title.y = element_text(size=17, face="bold", vjust=-3.5),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")+
theme(plot.margin = unit(c(0.6,0.6,0.6,0.6), "cm"))
bp
library(ggstance)
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=17, face="bold", vjust=3.5),
axis.title.y = element_text(size=17, face="bold", vjust=-3.5),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=17, face="bold", vjust=13.5),
axis.title.y = element_text(size=17, face="bold", vjust=-13.5),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=17, face="bold", vjust=-13.5),
axis.title.y = element_text(size=17, face="bold", vjust=13.5),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=17, face="bold", vjust=-4.5),
axis.title.y = element_text(size=17, face="bold", vjust=4.5),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")+
theme(plot.margin = unit(c(0.6,0.6,0.6,0.6), "cm"))
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=17, face="bold", vjust=-3.5),
axis.title.y = element_text(size=17, face="bold", vjust=3.5),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=17, face="bold", vjust=-3.5),
axis.title.y = element_text(size=17, face="bold", vjust=3.5),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=17, face="bold", vjust=-3.5),
axis.title.y = element_text(size=17, face="bold", vjust=1.5),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=17, face="bold", vjust=-1.5),
axis.title.y = element_text(size=17, face="bold", vjust=2),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=17, face="bold", vjust=-0.5),
axis.title.y = element_text(size=17, face="bold", vjust=2),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=17, face="bold", vjust=0.5),
axis.title.y = element_text(size=17, face="bold", vjust=2),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=2, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=17, face="bold", vjust=0.5),
axis.title.y = element_text(size=17, face="bold", vjust=1),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=2, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=16, face="bold", vjust=0.5),
axis.title.y = element_text(size=16, face="bold", vjust=1.5),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=4, color="grey", aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=16, face="bold", vjust=0.5),
axis.title.y = element_text(size=16, face="bold", vjust=1.5),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=4, color="darkgrey", aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=16, face="bold", vjust=0.5),
axis.title.y = element_text(size=16, face="bold", vjust=1.5),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=4, color="grey45", aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=16, face="bold", vjust=0.5),
axis.title.y = element_text(size=16, face="bold", vjust=1.5),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=4, color="grey55", aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=16, face="bold", vjust=0.5),
axis.title.y = element_text(size=16, face="bold", vjust=1.5),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=4, color="grey35", aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of S. perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=16, face="bold", vjust=0.5),
axis.title.y = element_text(size=16, face="bold", vjust=1.5),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=4, color="grey35", aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of Subulicystidium perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=16, face="bold", vjust=0.5),
axis.title.y = element_text(size=14, face="bold", vjust=2),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=4, color="grey35", aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of Subulicystidium perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=14, face="bold", vjust=0.5),
axis.title.y = element_text(size=12, face="bold", vjust=2),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=4, color="grey35", aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of Subulicystidium perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=14, face="bold", vjust=0.5),
axis.title.y = element_text(size=14, face="bold", vjust=2),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=4, color="grey35", aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of Subulicystidium perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=14, face="bold", vjust=0.5),
axis.title.y = element_text(size=13, face="bold", vjust=2),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=4, color="grey35", aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of Subulicystidium perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=14, face="bold", vjust=0.5),
axis.title.y = element_text(size=14, face="bold", vjust=2.5),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=4, color="grey35", aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of Subulicystidium perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=14, face="bold", vjust=0.5),
axis.title.y = element_text(size=14, face="bold", vjust=2.2),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_point(size=4, color="grey55", aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
geom_boxploth()+
labs(x="Mean length of cystidia, µm", y="Clade of Subulicystidium perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=14, face="bold", vjust=0.5),
axis.title.y = element_text(size=14, face="bold", vjust=2.2),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
library(ggstance)
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=4, color="grey55", aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of Subulicystidium perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=14, face="bold", vjust=0.5),
axis.title.y = element_text(size=14, face="bold", vjust=2.2),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=4, color="grey45", aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of Subulicystidium perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=14, face="bold", vjust=0.5),
axis.title.y = element_text(size=14, face="bold", vjust=2.2),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
rm(list=ls())
#setwd tells R where to look
setwd("G:/R/SUB_perlongisporum/morpho")
#use getwd to confirm that R is now looking here
getwd()
ranges.cys <- read.csv ("Cystidia_ranges_specimens_20190808_v1.csv",  sep=",")
ranges.cys.perl <- ranges.cys[which(ranges.cys$Species_ID=="perlongisporum"),]
library(ggplot2)
library(ggstance)
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2")))) +
geom_boxploth()+
geom_point(size=4, color="grey45", aes(x=Lmean, y=factor(perl_clade, level=c("clade 1", "clade 2"))))+
labs(x="Mean length of cystidia, µm", y="Clade of Subulicystidium perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=14, face="bold", vjust=0.5),
axis.title.y = element_text(size=14, face="bold", vjust=2.2),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
#Reset R's brain
rm(list=ls())
#setwd tells R where to look
setwd("G:/R/SUB_perlongisporum/morpho")
#use getwd to confirm that R is now looking here
getwd()
#Load cysre table and adjust it
ranges.cys <- read.csv ("Cystidia_ranges_specimens_20190808_v1.csv",  sep=",")
ranges.cys.perl <- ranges.cys[which(ranges.cys$Species_ID=="perlongisporum"),]
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 2", "clade 1")))) +
geom_boxploth()+
geom_point(size=4, color="grey45", aes(x=Lmean, y=factor(perl_clade, level=c("clade 2", "clade 1"))))+
labs(x="Mean length of cystidia, µm", y="Clade of Subulicystidium perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=14, face="bold", vjust=0.5),
axis.title.y = element_text(size=14, face="bold", vjust=2.2),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
library(ggplot2)
library(ggstance)
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 2", "clade 1")))) +
geom_boxploth()+
geom_point(size=4, color="grey45", aes(x=Lmean, y=factor(perl_clade, level=c("clade 2", "clade 1"))))+
labs(x="Mean length of cystidia, µm", y="Clade of Subulicystidium perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=14, face="bold", vjust=0.5),
axis.title.y = element_text(size=14, face="bold", vjust=2.2),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
#Reset R's brain
rm(list=ls())
#setwd tells R in which directory to work with data
setwd("G:/R/SUB_perlongisporum/phylo perl facetplot")
#use getwd to confirm that R is now looking here
getwd()
###############################################################################
# Load required packages
###############################################################################
library(ape)
library(ggtree)
library(ggstance)
library(Hmisc)
library(gdata) # messages on absent perl interpreter can be ignored
library(treeio)
#Load tree
tree.unr <- read.tree("perl its PhyML_newick_tree.nhx")
outgroup <- c("Ordynets_00158", "TU_124387",
"TU_124388", "ARAN_4160", "KAS_L_0103")
tree <-root(tree.unr, outgroup)
annot.full <- read.csv ("SUB_spore_measurements_20190808_v2.csv",  sep=",")
annot.perl1 <- annot.full[which(annot.full$Species_ID=="perlongisporum"), ]
annot.perl <- annot.perl1[c("Specimen_ID", "L_sp", "W_sp", "Q_sp")]
# Generate treedata object
p0<-ggtree(tree)
p1 <- p0 +
geom_tree(size=0.7) +
geom_tiplab(size=2.5, align=F, hjust=-0.01)
p2<- facet_plot(p1+xlim_tree(0.25), panel='Spore length, µm', data=annot.perl,
geom=geom_boxploth, mapping = aes(x=L_sp, group=label))
p3<- facet_plot(p2, panel='Spore width, µm', data=annot.perl,
geom=geom_boxploth, mapping = aes(x=W_sp, group=label))
p4<- facet_plot(p3, panel='Spore length/width ratio', data=annot.perl,
geom=geom_boxploth, mapping = aes(x=Q_sp, group=label)) +
theme_tree2()
print(p4)
rm(list=ls())
#setwd tells R in which directory to work with data
setwd("G:/R/SUB_perlongisporum/phylo perl facetplot")
#use getwd to confirm that R is now looking here
getwd()
library(ape)
library(ggtree)
library(ggstance)
library(Hmisc)
library(gdata) # messages on absent perl interpreter can be ignored
library(treeio)
#Load tree
tree.unr <- read.tree("perl its PhyML_newick_tree.nhx")
#to check the tree struture use
#str(tree)
#Load tree
tree.unr <- read.tree("perl its PhyML_newick_tree.nhx")
#to check the tree struture use
#str(tree)
#Rooting and adjusting tip order
outgroup <- c("Ordynets_00158", "TU_124387",
"TU_124388", "ARAN_4160", "KAS_L_0103")
tree <-root(tree.unr, outgroup)
# Loading metadata to use for tree annotation
annot.full <- read.csv ("SUB_spore_measurements_20190808_v2.csv",  sep=",")
annot.perl1 <- annot.full[which(annot.full$Species_ID=="perlongisporum"), ]
annot.perl <- annot.perl1[c("Specimen_ID", "L_sp", "W_sp", "Q_sp")]
# Generate treedata object
p0<-ggtree(tree)
p1 <- p0 +
geom_tree(size=0.7) +
geom_tiplab(size=2.5, align=F, hjust=-0.01)
p2<- facet_plot(p1+xlim_tree(0.25), panel='Spore length, µm', data=annot.perl,
geom=geom_boxploth, mapping = aes(x=L_sp, group=label))
p3<- facet_plot(p2, panel='Spore width, µm', data=annot.perl,
geom=geom_boxploth, mapping = aes(x=W_sp, group=label))
p4<- facet_plot(p3, panel='Spore length/width ratio', data=annot.perl,
geom=geom_boxploth, mapping = aes(x=Q_sp, group=label)) +
theme_tree2()
print(p4)
#Reset R's brain
rm(list=ls())
#setwd tells R where to look
setwd("G:/R/SUB_perlongisporum/morpho")
#use getwd to confirm that R is now looking here
getwd()
#Load cysre table and adjust it
ranges.cys <- read.csv ("Cystidia_ranges_specimens_20190808_v1.csv",  sep=",")
ranges.cys.perl <- ranges.cys[which(ranges.cys$Species_ID=="perlongisporum"),]
library(ggplot2)
library(ggstance)
bp <- ggplot(ranges.cys.perl, aes(x=Lmean, y=factor(perl_clade, level=c("clade 2", "clade 1")))) +
geom_boxploth()+
geom_point(size=4, color="grey45", aes(x=Lmean, y=factor(perl_clade, level=c("clade 2", "clade 1"))))+
labs(x="Mean length of cystidia, µm", y="Clade of Subulicystidium perlongisporum")+
theme(plot.title = element_text(hjust = 0.5, size=20, face="bold"),
axis.title.x = element_text(size=14, face="bold", vjust=0.5),
axis.title.y = element_text(size=14, face="bold", vjust=2.2),
axis.text.x=element_text(colour="grey40", size=15),
axis.text.y=element_text(colour="grey40", size=15))+
theme(legend.position = "none")
bp
rm(list=ls())
#setwd tells R in which directory to work with data
setwd("G:/R/SUB_perlongisporum/phylo perl facetplot")
#use getwd to confirm that R is now looking here
getwd()
library(ape)
library(ggtree)
library(ggstance)
library(Hmisc)
library(gdata) # messages on absent perl interpreter can be ignored
library(treeio)
tree.unr <- read.tree("perl its PhyML_newick_tree.nhx")
#to check the tree struture use
#str(tree)
#Rooting and adjusting tip order
outgroup <- c("Ordynets_00158", "TU_124387",
"TU_124388", "ARAN_4160", "KAS_L_0103")
tree <-root(tree.unr, outgroup)
# Loading metadata to use for tree annotation
annot.full <- read.csv ("SUB_cystidia_measurements_20190808_v1.2.csv",  sep=",")
annot.perl1 <- annot.full[which(annot.full$Species_ID=="perlongisporum"), ]
annot.perl <- annot.perl1[c("Specimen_ID", "L_sp", "W_sp", "Q_sp")]
p0<-ggtree(tree)
p1 <- p0 +
geom_tree(size=0.7) +
geom_tiplab(size=2.5, align=F, hjust=-0.01)
p2<- facet_plot(p1+xlim_tree(0.25), panel='Cystidia length, µm', data=annot.perl,
geom=geom_boxploth, mapping = aes(x=L_sp, group=label))
p3<- facet_plot(p2, panel='Cystidia width, µm', data=annot.perl,
geom=geom_boxploth, mapping = aes(x=W_sp, group=label))
p4<- facet_plot(p3, panel='Cystidia length/width ratio', data=annot.perl,
geom=geom_boxploth, mapping = aes(x=Q_sp, group=label)) +
theme_tree2()
print(p4)
#Load tree
tree.unr <- read.tree("perl its PhyML_newick_tree.nhx")
#to check the tree struture use
#str(tree)
#Rooting and adjusting tip order
outgroup <- c("Ordynets_00158", "TU_124387",
"TU_124388", "ARAN_4160", "KAS_L_0103")
tree <-root(tree.unr, outgroup)
# Loading metadata to use for tree annotation
annot.full <- read.csv ("SUB_spore_measurements_20190808_v2.csv",  sep=",")
annot.perl1 <- annot.full[which(annot.full$Species_ID=="perlongisporum"), ]
annot.perl <- annot.perl1[c("Specimen_ID", "L_sp", "W_sp", "Q_sp")]
p0<-ggtree(tree)
p1 <- p0 +
geom_tree(size=0.7) +
geom_tiplab(size=2.5, align=F, hjust=-0.01)
p2<- facet_plot(p1+xlim_tree(0.25), panel='Spore length, µm', data=annot.perl,
geom=geom_boxploth, mapping = aes(x=L_sp, group=label))
p3<- facet_plot(p2, panel='Spore width, µm', data=annot.perl,
geom=geom_boxploth, mapping = aes(x=W_sp, group=label))
p4<- facet_plot(p3, panel='Spore length/width ratio', data=annot.perl,
geom=geom_boxploth, mapping = aes(x=Q_sp, group=label)) +
theme_tree2()
print(p4)
